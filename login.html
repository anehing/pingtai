<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="x-ua-compatible" content="ie=7" />
<title>九点代驾</title>

<link href="styles/login.css" rel="stylesheet" type="text/css" />
<style type="text/css">
</style>
<script type="text/javascript" src="scripts/jquery-1.3.2.js"></script>
<script type="text/javascript" src="scripts/jquery.form.js"></script>
<script type="text/javascript">
	function tohref(url) {
		mesg = open(
				url,
				"",
				"toolbar=no,,menubar=no,location=no,scrollbars=yes,resizable=no,width=600,height=330");
	}
	function login() {

		var url = "lfx/login.action";
		var queryString = $(document.getElementById("loginForm")).formSerialize();
		//queryString="username=test&password=test&tmpImg=us78"
		$.post(url, queryString, loginCallback);

	}

	function loginCallback(data) {

		try {

			var obj = eval("(" + data + ")");

			if (obj.result == true) {
				window.location = "index.html";
			} else {
				changeImg();
				alert(obj.message);

			}

		} catch (e) {
			changeImg();
			alert("登录失败");

		}

	}
	function registered() {
		window.location.href = 'lfx/addRegisteredUserQueryAll.action';
	}
	function goPass() {
		var Sys = {};
		var ua = navigator.userAgent.toLowerCase();
		var s;
		(s = ua.match(/msie ([\d.]+)/)) ? Sys.ie = s[1] : (s = ua
				.match(/firefox\/([\d.]+)/)) ? Sys.firefox = s[1] : (s = ua
				.match(/chrome\/([\d.]+)/)) ? Sys.chrome = s[1] : (s = ua
				.match(/opera.([\d.]+)/)) ? Sys.opera = s[1] : (s = ua
				.match(/version\/([\d.]+).*safari/)) ? Sys.safari = s[1] : 0;
		if (Sys.ie) {
			if (event.keyCode == 13) {
				//	event.keyCode = 9;
				login();
			}
		}
	}
	function goLogin() {
		var Sys = {};
		var ua = navigator.userAgent.toLowerCase();
		var s;
		(s = ua.match(/msie ([\d.]+)/)) ? Sys.ie = s[1] : (s = ua
				.match(/firefox\/([\d.]+)/)) ? Sys.firefox = s[1] : (s = ua
				.match(/chrome\/([\d.]+)/)) ? Sys.chrome = s[1] : (s = ua
				.match(/opera.([\d.]+)/)) ? Sys.opera = s[1] : (s = ua
				.match(/version\/([\d.]+).*safari/)) ? Sys.safari = s[1] : 0;
		if (Sys.ie) {
			if (event.keyCode == 13) {
				login();
				// event.keyCode = 9;
			}
		}
	}

	function getBodyHeight() {

		var de = document.documentElement;

		var db = document.body;

		var viewW = de.clientWidth == 0 ? db.clientWidth : de.clientWidth;

		var viewH = de.clientHeight == 0 ? db.clientHeight : de.clientHeight;

		return viewH;

	}

	function getBodyWidth() {

		var de = document.documentElement;

		var db = document.body;

		var viewW = de.clientWidth == 0 ? db.clientWidth : de.clientWidth;

		var viewH = de.clientHeight == 0 ? db.clientHeight : de.clientHeight;

		return viewW;

	}

	$(function() {

		var bgObj = document.getElementById("bg");

		bgObj.style.top = (getBodyHeight() / 2 - 150) + "px"

		bgObj.style.left = (getBodyWidth() / 2 - 300) + "px"

		var _bgObj = document.getElementById("_bg");

		_bgObj.style.top = (getBodyHeight() / 2 + 100) + "px"

		_bgObj.style.left = (getBodyWidth() / 2 - 210) + "px"

	});
	function check() {
		var name = document.getElementById("username").value;
		var pass = document.getElementById("password").value;
		var tmpImg = document.getElementById("tmpImg").value;
		if (name == null || name == "" || pass == null || pass == "") {
			alert("用户名或密码不能为空！");
		} else if (tmpImg == null || tmpImg == "") {
			alert("验证码不能为空！");
		} else {
			login();
		}

	}

	function changeImg() {

		var _tmpVC = document.getElementById("tmpVC");

		var rNum = Math.round(Math.random() * 10000);

		_tmpVC.src = "lfx/randomImg.action?r=" + rNum;

	}
	function EnterforUser() {
		if (window.event.keyCode == 13)
			document.loginForm.password.focus();
		if (!((window.event.keyCode >= 64 && window.event.keyCode <= 90)
				|| (window.event.keyCode >= 97 && window.event.keyCode <= 122)
				|| (window.event.keyCode == 45) || (window.event.keyCode == 46)
				|| (window.event.keyCode == 95) || (window.event.keyCode >= 48 && window.event.keyCode <= 57)))
			window.event.keyCode = 0;
	}

	function EnterforPass() {
		if (window.event.keyCode == 13)
			document.loginForm.tmpImg.focus();
		if (!((window.event.keyCode >= 64 && window.event.keyCode <= 90)
				|| (window.event.keyCode >= 97 && window.event.keyCode <= 122)
				|| (window.event.keyCode == 45) || (window.event.keyCode == 46)
				|| (window.event.keyCode == 95) || (window.event.keyCode >= 48 && window.event.keyCode <= 57)))
			window.event.keyCode = 0;
	}

	function EnterforCheck() {
		if (window.event.keyCode == 13)
			check();
		if (!((window.event.keyCode >= 64 && window.event.keyCode <= 90)
				|| (window.event.keyCode >= 97 && window.event.keyCode <= 122)
				|| (window.event.keyCode == 45) || (window.event.keyCode == 46)
				|| (window.event.keyCode == 95) || (window.event.keyCode >= 48 && window.event.keyCode <= 57)))
			window.event.keyCode = 0;
	}
	//发现自己被嵌套则刷新页面

	if (self != top)
		top.location = self.location;
</script>

</head>

<body oncontextmenu="window.status='';return false;">
	<form id="loginForm" name="loginForm">
		<div id="bg" class="dd_1"></div>
		<div id="_bg" class="dd_2">
			<table border="0" cellspacing="0" cellpadding="0" width="540px">
				<tr>
					<td align="right" colspan="7"><span
						style="color: rgb(255, 255, 255);">Version: 1.0&nbsp;</span></td>
				</tr>
				<tr height="30">
					<td align="right" width="50px;">用户名：</td>
					<td width="120px;">
					    <input name="username" type="text"
						      maxlength="20" onkeypress="EnterforUser ()"
						      class="input" id="username" value="admin" />
				    </td>
					<td align="right" width="50px;">密码：</td>
					<td width="110px;">
					    <input name="password" type="password"
						       maxlength="20" onkeypress="EnterforPass ()"
						       class="input" id="password" value="123" />
				    </td>
					<td align="right" width="60px;">验证码：</td>
					<td width="50px;">
					    <input name="tmpImg" id="tmpImg" type="text" 
					           onkeypress="EnterforCheck ()"
						       class="input2" />
					</td>
					<td width="65px;">
					    <img id="tmpVC" alt="换张图片" title="换张图片"
						     src="lfx/randomImg.action" height="22px;" onclick="changeImg();"
						     style="cursor: pointer;" />
				    </td>
				</tr>
				<tr height="26" valign="bottom">
					<td colspan="5" align="center">
					   <a href="#" onclick="check();">
							<img class="login" style="border: 0px;" src="images/anniu.gif" width="90" height="28" />
					   </a> 
					   <a href="#" onclick="tohref('regUserByMobile.jsp?pa=111&um=admin&date=2112');">
							<img style="border: 0px;" class="login" src="images/anniu01.gif" width="90" height="28" />
					   </a>
					</td>
					<td align="center" colspan="2" valign="middle">
					    <a href="#" onclick="changeImg();">看不清，换一张？</a>
				    </td>
				</tr>

			</table>
		</div>
	</form>
</body>
</html>
